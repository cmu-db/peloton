[
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "r", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "foo%rowtype"}}}}, {"PLpgSQL_row": {"refname": "*internal*", "lineno": 5, "fields": [{"name": "r", "varno": 1}]}}], "action": {"PLpgSQL_stmt_block": {"lineno": 4, "body": [{"PLpgSQL_stmt_fors": {"lineno": 5, "row": {"PLpgSQL_row": {"refname": "*internal*", "lineno": 5, "fields": [{"name": "r", "varno": 1}]}}, "body": [{"PLpgSQL_stmt_return_next": {"lineno": 9}}],"query": {"PLpgSQL_expr": {"query": "SELECT * FROM foo WHERE fooid > 0"}}}}, {"PLpgSQL_stmt_return": {"lineno": 11}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 2, "body": [{"PLpgSQL_stmt_return_query": {"lineno": 3, "query": {"PLpgSQL_expr": {"query": "SELECT flightid\n                   FROM flight\n                  WHERE flightdate >= $1\n                    AND flightdate < ($1 + 1)"}}}}, {"PLpgSQL_stmt_if": {"lineno": 10, "cond": {"PLpgSQL_expr": {"query": "SELECT NOT FOUND"}}, "then_body": [{"PLpgSQL_stmt_raise": {"lineno": 11, "elog_level": 20, "message": "No flight at %.", "params": [{"PLpgSQL_expr": {"query": "SELECT $1"}}]}}]}}, {"PLpgSQL_stmt_return": {"lineno": 14}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 2, "body": [{"PLpgSQL_stmt_if": {"lineno": 3, "cond": {"PLpgSQL_expr": {"query": "SELECT v_version IS NULL"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT v_name"}}}}]}}, {"PLpgSQL_stmt_return": {"lineno": 6, "expr": {"PLpgSQL_expr": {"query": "SELECT v_name || '/' || v_version"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "a_running_job_count", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_row": {"refname": "*internal*", "lineno": 7, "fields": [{"name": "a_running_job_count", "varno": 1}]}}, {"PLpgSQL_var": {"refname": "sqlstate", "lineno": 18, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}, "isconst": true}}, {"PLpgSQL_var": {"refname": "sqlerrm", "lineno": 18, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}, "isconst": true}}], "action": {"PLpgSQL_stmt_block": {"lineno": 4, "body": [{"PLpgSQL_stmt_execsql": {"lineno": 5, "sqlstmt": {"PLpgSQL_expr": {"query": "LOCK TABLE cs_jobs IN EXCLUSIVE MODE"}}}}, {"PLpgSQL_stmt_execsql": {"lineno": 7, "sqlstmt": {"PLpgSQL_expr": {"query": "SELECT count(*)                          FROM cs_jobs WHERE end_stamp IS NULL"}}, "into": true, "row": {"PLpgSQL_row": {"refname": "*internal*", "lineno": 7, "fields": [{"name": "a_running_job_count", "varno": 1}]}}}}, {"PLpgSQL_stmt_if": {"lineno": 9, "cond": {"PLpgSQL_expr": {"query": "SELECT a_running_job_count > 0"}}, "then_body": [{"PLpgSQL_stmt_raise": {"lineno": 10, "elog_level": 20, "message": "Unable to create a new job: a job is currently running"}}]}}, {"PLpgSQL_stmt_execsql": {"lineno": 13, "sqlstmt": {"PLpgSQL_expr": {"query": "DELETE FROM cs_active_job"}}}}, {"PLpgSQL_stmt_execsql": {"lineno": 14, "sqlstmt": {"PLpgSQL_expr": {"query": "INSERT INTO cs_active_job(job_id) VALUES (v_job_id)"}}}}, {"PLpgSQL_stmt_block": {"lineno": 16, "body": [{"PLpgSQL_stmt_execsql": {"lineno": 17, "sqlstmt": {"PLpgSQL_expr": {"query": "INSERT INTO cs_jobs (job_id, start_stamp) VALUES (v_job_id, now())"}}}}],"exceptions": {"PLpgSQL_exception_block": {"exc_list": [{"PLpgSQL_exception": {"conditions": [{"PLpgSQL_condition": {"condname": "unique_violation"}}]}}]}}}}, {"PLpgSQL_stmt_return": {}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "pos", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 4, "body": [{"PLpgSQL_stmt_assign": {"lineno": 5, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT instr($1, $2, 1)"}}}}, {"PLpgSQL_stmt_return": {"lineno": 6, "expr": {"PLpgSQL_expr": {"query": "SELECT pos"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "pos", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "integer "}}, "notnull": true, "default_val": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}, {"PLpgSQL_var": {"refname": "temp_str", "lineno": 4, "datatype": {"PLpgSQL_type": {"typname": "varchar"}}}}, {"PLpgSQL_var": {"refname": "beg", "lineno": 5, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "length", "lineno": 6, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "ss_length", "lineno": 7, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 8, "body": [{"PLpgSQL_stmt_if": {"lineno": 9, "cond": {"PLpgSQL_expr": {"query": "SELECT beg_index > 0"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 10, "varno": 2, "expr": {"PLpgSQL_expr": {"query": "SELECT substring(string FROM beg_index)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 11, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT position(string_to_search IN temp_str)"}}}}, {"PLpgSQL_stmt_if": {"lineno": 13, "cond": {"PLpgSQL_expr": {"query": "SELECT pos = 0"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 14, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}],"else_body": [{"PLpgSQL_stmt_return": {"lineno": 16, "expr": {"PLpgSQL_expr": {"query": "SELECT pos + beg_index - 1"}}}}]}}],"elsif_list": [{"PLpgSQL_if_elsif": {"lineno": 18, "cond": {"PLpgSQL_expr": {"query": "SELECT beg_index < 0"}}, "stmts": [{"PLpgSQL_stmt_assign": {"lineno": 19, "varno": 5, "expr": {"PLpgSQL_expr": {"query": "SELECT char_length(string_to_search)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 20, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT char_length(string)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 21, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT length + beg_index - ss_length + 2"}}}}, {"PLpgSQL_stmt_while": {"lineno": 23, "cond": {"PLpgSQL_expr": {"query": "SELECT beg > 0"}}, "body": [{"PLpgSQL_stmt_assign": {"lineno": 24, "varno": 2, "expr": {"PLpgSQL_expr": {"query": "SELECT substring(string FROM beg FOR ss_length)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 25, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT position(string_to_search IN temp_str)"}}}}, {"PLpgSQL_stmt_if": {"lineno": 27, "cond": {"PLpgSQL_expr": {"query": "SELECT pos > 0"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 28, "expr": {"PLpgSQL_expr": {"query": "SELECT beg"}}}}]}}, {"PLpgSQL_stmt_assign": {"lineno": 31, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT beg - 1"}}}}]}}, {"PLpgSQL_stmt_return": {"lineno": 34, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}]}}], "else_body": [{"PLpgSQL_stmt_return": {"lineno": 36, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}]}}, {"PLpgSQL_stmt_return": {}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "pos", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "integer "}}, "notnull": true, "default_val": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}, {"PLpgSQL_var": {"refname": "occur_number", "lineno": 4, "datatype": {"PLpgSQL_type": {"typname": "integer "}}, "notnull": true, "default_val": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}, {"PLpgSQL_var": {"refname": "temp_str", "lineno": 5, "datatype": {"PLpgSQL_type": {"typname": "varchar"}}}}, {"PLpgSQL_var": {"refname": "beg", "lineno": 6, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "i", "lineno": 7, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "length", "lineno": 8, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "ss_length", "lineno": 9, "datatype": {"PLpgSQL_type": {"typname": "integer"}}}}, {"PLpgSQL_var": {"refname": "i", "lineno": 15, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 10, "body": [{"PLpgSQL_stmt_if": {"lineno": 11, "cond": {"PLpgSQL_expr": {"query": "SELECT beg_index > 0"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 12, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT beg_index"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 13, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT substring(string FROM beg_index)"}}}}, {"PLpgSQL_stmt_fori": {"lineno": 15, "var": {"PLpgSQL_var": {"refname": "i", "lineno": 15, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, "lower": {"PLpgSQL_expr": {"query": "SELECT 1"}}, "upper": {"PLpgSQL_expr": {"query": "SELECT occur_index"}}, "body": [{"PLpgSQL_stmt_assign": {"lineno": 16, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT position(string_to_search IN temp_str)"}}}}, {"PLpgSQL_stmt_if": {"lineno": 18, "cond": {"PLpgSQL_expr": {"query": "SELECT i = 1"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 19, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT beg + pos - 1"}}}}],"else_body": [{"PLpgSQL_stmt_assign": {"lineno": 21, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT beg + pos"}}}}]}}, {"PLpgSQL_stmt_assign": {"lineno": 24, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT substring(string FROM beg + 1)"}}}}]}}, {"PLpgSQL_stmt_if": {"lineno": 27, "cond": {"PLpgSQL_expr": {"query": "SELECT pos = 0"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 28, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}],"else_body": [{"PLpgSQL_stmt_return": {"lineno": 30, "expr": {"PLpgSQL_expr": {"query": "SELECT beg"}}}}]}}],"elsif_list": [{"PLpgSQL_if_elsif": {"lineno": 32, "cond": {"PLpgSQL_expr": {"query": "SELECT beg_index < 0"}}, "stmts": [{"PLpgSQL_stmt_assign": {"lineno": 33, "varno": 7, "expr": {"PLpgSQL_expr": {"query": "SELECT char_length(string_to_search)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 34, "varno": 6, "expr": {"PLpgSQL_expr": {"query": "SELECT char_length(string)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 35, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT length + beg_index - ss_length + 2"}}}}, {"PLpgSQL_stmt_while": {"lineno": 37, "cond": {"PLpgSQL_expr": {"query": "SELECT beg > 0"}}, "body": [{"PLpgSQL_stmt_assign": {"lineno": 38, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT substring(string FROM beg FOR ss_length)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 39, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT position(string_to_search IN temp_str)"}}}}, {"PLpgSQL_stmt_if": {"lineno": 41, "cond": {"PLpgSQL_expr": {"query": "SELECT pos > 0"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 42, "varno": 2, "expr": {"PLpgSQL_expr": {"query": "SELECT occur_number + 1"}}}}, {"PLpgSQL_stmt_if": {"lineno": 44, "cond": {"PLpgSQL_expr": {"query": "SELECT occur_number = occur_index"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 45, "expr": {"PLpgSQL_expr": {"query": "SELECT beg"}}}}]}}]}}, {"PLpgSQL_stmt_assign": {"lineno": 49, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT beg - 1"}}}}]}}, {"PLpgSQL_stmt_return": {"lineno": 52, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}]}}], "else_body": [{"PLpgSQL_stmt_return": {"lineno": 54, "expr": {"PLpgSQL_expr": {"query": "SELECT 0"}}}}]}}, {"PLpgSQL_stmt_return": {}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 1, "body": [{"PLpgSQL_stmt_if": {"lineno": 2, "cond": {"PLpgSQL_expr": {"query": "SELECT canceled = true"}}, "then_body": [{"PLpgSQL_stmt_return": {"lineno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT null"}}}}],"else_body": [{"PLpgSQL_stmt_return": {"lineno": 5, "expr": {"PLpgSQL_expr": {"query": "SELECT endDate"}}}}]}}, {"PLpgSQL_stmt_return": {}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 1, "body": [{"PLpgSQL_stmt_return": {"lineno": 2, "expr": {"PLpgSQL_expr": {"query": "SELECT (calcule_duree(date_inscription,date_observation) + 1)"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "theday", "lineno": 2, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}, {"PLpgSQL_var": {"refname": "themonth", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}, {"PLpgSQL_var": {"refname": "theyear", "lineno": 4, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}, {"PLpgSQL_var": {"refname": "theday_now", "lineno": 5, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}, {"PLpgSQL_var": {"refname": "themonth_now", "lineno": 6, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}, {"PLpgSQL_var": {"refname": "theyear_now", "lineno": 7, "datatype": {"PLpgSQL_type": {"typname": "INTEGER"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 8, "body": [{"PLpgSQL_stmt_assign": {"lineno": 9, "varno": 1, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(DAY FROM origine)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 10, "varno": 2, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(MONTH FROM origine)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 11, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(YEAR FROM origine)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 13, "varno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(DAY FROM atDate)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 14, "varno": 5, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(MONTH FROM atDate)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 15, "varno": 6, "expr": {"PLpgSQL_expr": {"query": "SELECT EXTRACT(YEAR FROM atDate)"}}}}, {"PLpgSQL_stmt_assign": {"lineno": 17, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT theYear_now - theYear"}}}}, {"PLpgSQL_stmt_if": {"lineno": 18, "cond": {"PLpgSQL_expr": {"query": "SELECT theMonth_now <= theMonth"}}, "then_body": [{"PLpgSQL_stmt_if": {"lineno": 19, "cond": {"PLpgSQL_expr": {"query": "SELECT theMonth = theMonth_now"}}, "then_body": [{"PLpgSQL_stmt_if": {"lineno": 20, "cond": {"PLpgSQL_expr": {"query": "SELECT theDay > theDay_now"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 21, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT theYear - 1"}}}}]}}],"else_body": [{"PLpgSQL_stmt_assign": {"lineno": 24, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT theYear - 1"}}}}]}}]}}, {"PLpgSQL_stmt_return": {"lineno": 28, "expr": {"PLpgSQL_expr": {"query": "SELECT theYear"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "memberid", "lineno": 2, "datatype": {"PLpgSQL_type": {"typname": "int4"}}}}, {"PLpgSQL_row": {"refname": "*internal*", "lineno": 5, "fields": [{"name": "memberid", "varno": 1}]}}], "action": {"PLpgSQL_stmt_block": {"lineno": 4, "body": [{"PLpgSQL_stmt_execsql": {"lineno": 5, "sqlstmt": {"PLpgSQL_expr": {"query": "SELECT key                FROM\n\t\tmember\n\tWHERE\n\t\tuidmember = uid"}}, "into": true, "row": {"PLpgSQL_row": {"refname": "*internal*", "lineno": 5, "fields": [{"name": "memberid", "varno": 1}]}}}}, {"PLpgSQL_stmt_return": {"lineno": 11, "expr": {"PLpgSQL_expr": {"query": "SELECT memberID"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "lastjob", "lineno": 2, "datatype": {"PLpgSQL_type": {"typname": "RECORD"}}}}, {"PLpgSQL_var": {"refname": "lastemployer", "lineno": 3, "datatype": {"PLpgSQL_type": {"typname": "record"}}}}, {"PLpgSQL_var": {"refname": "updatejob", "lineno": 4, "datatype": {"PLpgSQL_type": {"typname": "BOOL"}}}}, {"PLpgSQL_row": {"refname": "*internal*", "lineno": 8, "fields": [{"name": "lastjob", "varno": 1}]}}, {"PLpgSQL_row": {"refname": "*internal*", "lineno": 13, "fields": [{"name": "lastemployer", "varno": 2}]}}], "action": {"PLpgSQL_stmt_block": {"lineno": 5, "body": [{"PLpgSQL_stmt_assign": {"lineno": 6, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT false"}}}}, {"PLpgSQL_stmt_execsql": {"lineno": 8, "sqlstmt": {"PLpgSQL_expr": {"query": "SELECT *              FROM lire_lastJob(memberID) AS (jobID INT,startsupport DATE,jobEnd DATE)"}}, "into": true, "row": {"PLpgSQL_row": {"refname": "*internal*", "lineno": 8, "fields": [{"name": "lastjob", "varno": 1}]}}}}, {"PLpgSQL_stmt_if": {"lineno": 9, "cond": {"PLpgSQL_expr": {"query": "SELECT lastJob.jobID = jobID"}}, "then_body": [{"PLpgSQL_stmt_execsql": {"lineno": 10, "sqlstmt": {"PLpgSQL_expr": {"query": "SELECT\n\t\t\tr_perlab.key AS positionHeld,\n\t\t\tr_perlab.endDate AS positionEnd\n\t\t                    FROM\n\t\t\tr_perlab,\n\t\t\t(SELECT\n\t\t\t\tr_perlab.key_member AS col_memberID,\n\t\t\t\tmax(r_perlab.start) AS startrattachement\n\t\t\tFROM r_perlab\n\t\t\tGROUP BY col_memberID) positions\n\t\tWHERE ((positions.col_memberID = memberID) AND (r_perlab.key_member = positions.col_memberID) AND (r_perlab.start = startrattachement))"}}, "into": true, "row": {"PLpgSQL_row": {"refname": "*internal*", "lineno": 13, "fields": [{"name": "lastemployer", "varno": 2}]}}}}, {"PLpgSQL_stmt_if": {"lineno": 23, "cond": {"PLpgSQL_expr": {"query": "SELECT lastEmployer.positionHeld IS NOT NULL"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 24, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT true"}}}}, {"PLpgSQL_stmt_execsql": {"lineno": 25, "sqlstmt": {"PLpgSQL_expr": {"query": "UPDATE r_perlab SET endDate = jobEnd WHERE key = lastEmployer.positionHeld"}}}}]}}]}}, {"PLpgSQL_stmt_return": {"lineno": 29, "expr": {"PLpgSQL_expr": {"query": "SELECT updateJob"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_var": {"refname": "spechar", "lineno": 4, "datatype": {"PLpgSQL_type": {"typname": "VARCHAR[ ] "}}, "default_val": {"PLpgSQL_expr": {"query": "SELECT ARRAY['à','â','é','è','ê','ë','ï','î','ô','û','ù','À','Â','É','È','Ê','Ë','Ï','Î','ô','û','ù','ç' ]"}}}}, {"PLpgSQL_var": {"refname": "lettres", "lineno": 5, "datatype": {"PLpgSQL_type": {"typname": "VARCHAR[ ] "}}, "default_val": {"PLpgSQL_expr": {"query": "SELECT ARRAY['a','a','e','e','e','e','i','i','o','u','u','a','a','e','e','e','e','i','i','o','u','u','c' ]"}}}}, {"PLpgSQL_var": {"refname": "resultat", "lineno": 6, "datatype": {"PLpgSQL_type": {"typname": "VARCHAR"}}}}, {"PLpgSQL_var": {"refname": "nbrspechar", "lineno": 7, "datatype": {"PLpgSQL_type": {"typname": "INTEGER "}}, "default_val": {"PLpgSQL_expr": {"query": "SELECT 23"}}}}, {"PLpgSQL_var": {"refname": "i", "lineno": 12, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}], "action": {"PLpgSQL_stmt_block": {"lineno": 9, "body": [{"PLpgSQL_stmt_if": {"lineno": 10, "cond": {"PLpgSQL_expr": {"query": "SELECT (str IS NOT NULL)"}}, "then_body": [{"PLpgSQL_stmt_assign": {"lineno": 11, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT str"}}}}, {"PLpgSQL_stmt_fori": {"lineno": 12, "var": {"PLpgSQL_var": {"refname": "i", "lineno": 12, "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, "lower": {"PLpgSQL_expr": {"query": "SELECT 1"}}, "upper": {"PLpgSQL_expr": {"query": "SELECT nbrspechar"}}, "body": [{"PLpgSQL_stmt_assign": {"lineno": 13, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT regexp_replace(resultat,spechar[i],lettres[i],'g')"}}}}]}}]}}, {"PLpgSQL_stmt_return": {"lineno": 16, "expr": {"PLpgSQL_expr": {"query": "SELECT resultat"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_rec": {"refname": "new"}}, {"PLpgSQL_rec": {"refname": "old"}}, {"PLpgSQL_recfield": {"fieldname": "name", "recparentno": 1}}, {"PLpgSQL_recfield": {"fieldname": "name", "recparentno": 1}}], "action": {"PLpgSQL_stmt_block": {"lineno": 3, "body": [{"PLpgSQL_stmt_assign": {"lineno": 4, "varno": 3, "expr": {"PLpgSQL_expr": {"query": "SELECT upper(cleanString(NEW.name))"}}}}, {"PLpgSQL_stmt_return": {"lineno": 5, "expr": {"PLpgSQL_expr": {"query": "SELECT NEW"}}}}]}}}},
{"PLpgSQL_function": {"datums": [{"PLpgSQL_var": {"refname": "found", "datatype": {"PLpgSQL_type": {"typname": "UNKNOWN"}}}}, {"PLpgSQL_rec": {"refname": "new"}}, {"PLpgSQL_rec": {"refname": "old"}}, {"PLpgSQL_recfield": {"fieldname": "key", "recparentno": 1}}], "action": {"PLpgSQL_stmt_block": {"lineno": 2, "body": [{"PLpgSQL_stmt_execsql": {"lineno": 3, "sqlstmt": {"PLpgSQL_expr": {"query": "INSERT INTO list(key,date) VALUES(NEW.key,NEW.end)"}}}}, {"PLpgSQL_stmt_return": {"lineno": 4, "expr": {"PLpgSQL_expr": {"query": "SELECT NEW"}}}}]}}}}
]
